HTTP를 기반으로 하는 웹 서비스는 `Connectless`방식으로 이전의 상태 정보를 유지할 수 없다. -> `Stateless`<br> 
정보가 유지되지 않으면, 매번 페이지를 이동할 때마다 로그인을 다시 하거나, 상품을 선택했는데 구매 페이지에서 선택한
상품의 정보가 없거나 하는 등의 문제가 발생할 수 있다.

결국 클라이언트의 상태 정보를 정보 조각 형태로 서버와 클라이언트(웹 브라우저)에 남기는 방식으로 문제를 해결한다.

이 정보 조각을 `쿠키(cookie)`라고 한다. 서버는 쿠키를 이용해서 세션 정보를 관리한다.

## 쿠키(Cookie)
쿠키의 데이터 형태는 Key와 Value로 구성되고 String 형태로 이루어져 있다.<br>
쿠키는 이러한 정보들을 웹 브라우저에 저장(정확히는 웹 브라우저를 이용하고 있는 컴퓨터에 저장)하고<br>
사용자가 요청할 때 그 정보를 함께 보내서 서버가 사용자를 식별할 수 있게 해준다.

### 사용 목적
* 세션 관리<br>
  서버가 알아야 할 정보들을 저장한다. (로그인, 사용자 닉네임, 접속 시간, 장바구니 등)
* 개인화<br>
  사용자마다 다르게 그 사람에게 적절한 페이지를 보여줄 수 있다.
* 트래킹(Traking) <br>
  사용자의 행동과 패턴을 분석하고 기록한다.

### 단점
* 방문했던 웹 사이트에 대한 정보 및 개인정보가 기록되기 때문에 사생활을 침해할 소지가 있다.
  * 웹 브라우저 자체에 쿠키 거부 기능을 이용하면 해결할 수 있지만 <br>
    쿠키 본래의 목적인 웹 브라우저와의 연결을 지속시키는 기능을 수행할 수 없는 경우가 발생한다. 
* 서버가 가지고 있는 것이 아니라 사용자에게 저장되기 때문에 임의로 고치거나 지울 수 있고, 가로채기도 쉬워<br>
  보안이 취약하다. 따라서 쿠키에는 민감하거나 중요한 정보를 담는 것은 위험하다.
  
이러한 단점을 보완해주는 것이 `세션`이다.

## 세션
세션 아이디는 웹 브라우저 당 1개씩 생성되어 웹 컨테이너에 저장되며 브라우저 종료시 소멸된다. -> 보안 유지<br>
로그인 한 사용자에 대해서만 세션을 생성하는 것이 아니라 로그아웃하면 새로운 사용자로 인식해서 새로운 세션이 생성된다.
(쿠키는 로그아웃 유무와 관계없이 삭제하지 않으면 유지된다.)<br>
각 클라이언트 마다 고유 Session ID를 부여한다.

세션은 서버에 저장되고 서버 자원을 사용하기 때문에 사용자가 많을 경우 소모되는 자원이 상당하다.<br>
이러한 자원 관리 차원에서 쿠키와 세션을 적절한 요소 및 기믕에 병행 사용하여<br>
서버 자원의 낭비를 방지하며 웹 사이트의 속도를 높일 수 있다.

아이디, 닉네임 등의 정보를 세션에 담아두면 요청이 있을 때마다 DB에 접근할 필요가 없어서 효율적이다.

### 세션의 동작 순서
1. 클라이언트가 페이지를 요청한다.(사용자가 웹사이트 접근)
2. 서버는 접근한 클라이언트의 Request-Header 필드인 Cookie를 확인하여, 클라이언트가 해당 Session-id를 보냈는지 확인한다.
3. Session-id가 존재하지 않는다면, 서버는 Session-id를 생성해 클라이언트에게 돌려준다.
4. 서버에서 클라이언트로 돌려준 Session-id를 쿠키를 사용해 서버에 저장한다.
5. 클라이언트는 재접속 시, 이 쿠키를 이용하여 Session-id 값을 서버에 전달

ex) 화면이 이동해도 로그인이 풀리지 않고 로그아웃하기 전까지 유지

## 쿠키 vs 세션 
쿠키와 세션의 차이점은 크게 상태 정보의 저장 위치이다.<br>
쿠키는 `클라이언트(=로컬PC)`에 저장하고, 세션은 `서버`에 저장한다.<br>

쿠키는 사용자의 편의를 위한 것이고 세션은 사용자나 다른 누군가에게 노출되면 안되는 중요한 정보들을 위한 것이다.

<img src="https://github.com/yuwltn/yuwltn/blob/main/photo/%EC%BF%A0%ED%82%A4%EC%84%B8%EC%85%98.PNG" width="800" height="400" >

쿠키로 노출시켜서는 안될 정보들을 고려해야 하고, <br>
그렇다고 세션을 남발하면 서버에 부담이 되어 과부하가 일어나기 때문에<br>
웹을 설계할 때는 정보에 대해서 쿠키에 저장할 지 세션에 저장할 지 적절한 판단을 내릴 수 있어야 한다.

## References
* https://devuna.tistory.com/23
* https://hahahoho5915.tistory.com/32
